# AI ä¼šè¯è®°å½• - MQTT Web UI é¡¹ç›®

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**åˆ›å»ºæ—¶é—´**: 2025-11-14
**AI åŠ©æ‰‹**: Claude (Sonnet 4.5)
**é¡¹ç›®åç§°**: MQTT Web UI ç®¡ç†ç•Œé¢
**é¡¹ç›®ç›®æ ‡**: ä¸º Eclipse Mosquitto MQTT æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ª Web å¯è§†åŒ–ç®¡ç†ç•Œé¢

---

## ğŸ¯ éœ€æ±‚èƒŒæ™¯

### ç”¨æˆ·åŸå§‹éœ€æ±‚
ç”¨æˆ·ä½¿ç”¨ **Eclipse Mosquitto** å¼€æºé¡¹ç›®æ­å»ºäº† MQTT æœåŠ¡å™¨ï¼Œä½†è¯¥æœåŠ¡ç¼ºå°‘ UI ç•Œé¢ã€‚ç”¨æˆ·å¸Œæœ›åˆ›å»ºä¸€ä¸ªé’ˆå¯¹ä»¥ä¸‹ MQTT æœåŠ¡çš„ Web ç®¡ç†ç•Œé¢ï¼š

**MQTT æœåŠ¡å™¨ä¿¡æ¯**:
- å®¹å™¨: `eclipse-mosquitto:latest`
- ç«¯å£æ˜ å°„: `0.0.0.0:5502->5502/tcp`
- æœåŠ¡å™¨åœ°å€: `27.191.2.71:5502`
- è®¤è¯ä¿¡æ¯:
  - ç”¨æˆ·å: `admin`
  - å¯†ç : `wjm234.CN`

**å·²æœ‰æµ‹è¯•æ–‡ä»¶**:
- `publisher.js` - æ¯ 2 ç§’å‘ `test` ä¸»é¢˜å‘å¸ƒä¸€æ¡æ¶ˆæ¯
- `subscriber.js` - è®¢é˜… `test` ä¸»é¢˜å¹¶æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æŠ€æœ¯æ ˆé€‰æ‹©

#### åç«¯
- **Node.js** - JavaScript è¿è¡Œæ—¶
- **Express** - Web æœåŠ¡æ¡†æ¶
- **MQTT.js** - MQTT å®¢æˆ·ç«¯åº“
- **WebSocket (ws)** - å®æ—¶åŒå‘é€šä¿¡

#### å‰ç«¯
- **åŸç”Ÿ HTML/CSS/JavaScript** - æ— æ¡†æ¶ä¾èµ–ï¼Œè½»é‡çº§
- **WebSocket API** - ä¸åç«¯å®æ—¶é€šä¿¡

#### å®¹å™¨åŒ–
- **Docker** - å®¹å™¨åŒ–éƒ¨ç½²
- **Docker Compose** - ç¼–æ’ç®¡ç†

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          WebSocket          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æµè§ˆå™¨å®¢æˆ·ç«¯   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   Node.js åç«¯    â”‚
â”‚   (Web UI)      â”‚                              â”‚   (server.js)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                                          â”‚ MQTT Protocol
                                                          â”‚
                                                          â–¼
                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                  â”‚ Eclipse Mosquittoâ”‚
                                                  â”‚   MQTT Broker    â”‚
                                                  â”‚  27.191.2.71:5502â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®æµç¨‹**:
1. ç”¨æˆ·åœ¨æµè§ˆå™¨æ“ä½œ (è¿æ¥/è®¢é˜…/å‘å¸ƒ)
2. å‰ç«¯é€šè¿‡ WebSocket å‘é€æŒ‡ä»¤åˆ°åç«¯
3. åç«¯ä½¿ç”¨ MQTT.js è¿æ¥åˆ° Mosquitto æœåŠ¡å™¨
4. MQTT æ¶ˆæ¯é€šè¿‡ WebSocket å®æ—¶æ¨é€åˆ°å‰ç«¯
5. å‰ç«¯æ›´æ–° UI æ˜¾ç¤º

---

## ğŸ“‚ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
mqtt/
â”œâ”€â”€ server.js                 # Node.js åç«¯æœåŠ¡å™¨ (ä¸»è¦é€»è¾‘)
â”œâ”€â”€ package.json              # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ package-lock.json         # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ Dockerfile                # Docker é•œåƒæ„å»ºé…ç½®
â”œâ”€â”€ docker-compose.yml        # Docker Compose ç¼–æ’é…ç½®
â”œâ”€â”€ .dockerignore             # Docker å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ README.md                 # é¡¹ç›®ä½¿ç”¨æ–‡æ¡£
â”œâ”€â”€ AI_SESSION_RECORD.md      # æœ¬æ–‡ä»¶ - AI ä¼šè¯è®°å½•
â”‚
â”œâ”€â”€ public/                   # å‰ç«¯é™æ€æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ index.html            # ä¸»é¡µé¢ (UI å¸ƒå±€)
â”‚   â”œâ”€â”€ style.css             # æ ·å¼æ–‡ä»¶ (æ¸å˜è‰²è®¾è®¡)
â”‚   â””â”€â”€ app.js                # å‰ç«¯é€»è¾‘ (WebSocket é€šä¿¡)
â”‚
â”œâ”€â”€ publisher.js              # æµ‹è¯•æ–‡ä»¶ - MQTT å‘å¸ƒè€…
â””â”€â”€ subscriber.js             # æµ‹è¯•æ–‡ä»¶ - MQTT è®¢é˜…è€…
```

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. åç«¯ WebSocket æœåŠ¡ (server.js)

**ä¸»è¦åŠŸèƒ½**:
- å¯åŠ¨ Express HTTP æœåŠ¡å™¨ (ç«¯å£ 3000)
- åˆ›å»º WebSocket æœåŠ¡å™¨
- å¤„ç†å®¢æˆ·ç«¯ WebSocket æ¶ˆæ¯
- ç®¡ç† MQTT å®¢æˆ·ç«¯è¿æ¥æ± 

**æ”¯æŒçš„ WebSocket æ¶ˆæ¯ç±»å‹**:

| æ¶ˆæ¯ç±»å‹ | æ–¹å‘ | è¯´æ˜ |
|---------|------|------|
| `connect` | å‰ç«¯â†’åç«¯ | è¿æ¥åˆ° MQTT æœåŠ¡å™¨ |
| `disconnect` | å‰ç«¯â†’åç«¯ | æ–­å¼€ MQTT è¿æ¥ |
| `subscribe` | å‰ç«¯â†’åç«¯ | è®¢é˜…æŒ‡å®šä¸»é¢˜ |
| `unsubscribe` | å‰ç«¯â†’åç«¯ | å–æ¶ˆè®¢é˜…ä¸»é¢˜ |
| `publish` | å‰ç«¯â†’åç«¯ | å‘å¸ƒæ¶ˆæ¯åˆ°ä¸»é¢˜ |
| `connected` | åç«¯â†’å‰ç«¯ | MQTT è¿æ¥æˆåŠŸé€šçŸ¥ |
| `disconnected` | åç«¯â†’å‰ç«¯ | MQTT æ–­å¼€è¿æ¥é€šçŸ¥ |
| `subscribed` | åç«¯â†’å‰ç«¯ | è®¢é˜…æˆåŠŸé€šçŸ¥ |
| `unsubscribed` | åç«¯â†’å‰ç«¯ | å–æ¶ˆè®¢é˜…æˆåŠŸé€šçŸ¥ |
| `published` | åç«¯â†’å‰ç«¯ | æ¶ˆæ¯å‘å¸ƒæˆåŠŸé€šçŸ¥ |
| `message` | åç«¯â†’å‰ç«¯ | æ¥æ”¶åˆ°çš„ MQTT æ¶ˆæ¯ |
| `error` | åç«¯â†’å‰ç«¯ | é”™è¯¯ä¿¡æ¯ |

**ä»£ç å…³é”®ç‚¹**:
```javascript
// æ¯ä¸ª WebSocket è¿æ¥åˆ›å»ºç‹¬ç«‹çš„ MQTT å®¢æˆ·ç«¯
mqttClient = mqtt.connect(`mqtt://${config.host}:${config.port}`, {
  username: config.username,
  password: config.password,
  clientId: `web_client_${Date.now()}`,  // å”¯ä¸€å®¢æˆ·ç«¯ ID
  clean: true,                            // æ¸…é™¤ä¼šè¯
  reconnectPeriod: 1000                   // è‡ªåŠ¨é‡è¿
});
```

### 2. å‰ç«¯ Web UI (public/)

#### index.html - é¡µé¢ç»“æ„

**ä¸»è¦åŒºåŸŸ**:
1. **å¤´éƒ¨å¯¼èˆª** - æ˜¾ç¤ºè¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨
2. **è¿æ¥é…ç½®é¢æ¿** - MQTT æœåŠ¡å™¨é…ç½®è¡¨å•
3. **ä¸»é¢˜è®¢é˜…é¢æ¿** - è®¢é˜…ç®¡ç†
4. **æ¶ˆæ¯å‘å¸ƒé¢æ¿** - å‘å¸ƒæ¶ˆæ¯è¡¨å•
5. **æ¶ˆæ¯ç›‘æ§é¢æ¿** - å®æ—¶æ˜¾ç¤ºæ¥æ”¶çš„æ¶ˆæ¯
6. **ç³»ç»Ÿæ—¥å¿—é¢æ¿** - æ˜¾ç¤ºæ“ä½œæ—¥å¿—

#### style.css - æ ·å¼è®¾è®¡

**è®¾è®¡ç‰¹ç‚¹**:
- æ¸å˜è‰²ä¸»é¢˜: `linear-gradient(135deg, #667eea 0%, #764ba2 100%)`
- å“åº”å¼å¸ƒå±€: æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- çŠ¶æ€æŒ‡ç¤ºå™¨: å¸¦å‘¼å¸ç¯æ•ˆæœçš„è¿æ¥çŠ¶æ€
- å¡ç‰‡å¼è®¾è®¡: æ¸…æ™°çš„å†…å®¹åˆ†åŒº
- æ»šåŠ¨æ¡ç¾åŒ–: è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼

#### app.js - å‰ç«¯é€»è¾‘

**æ ¸å¿ƒåŠŸèƒ½**:

1. **WebSocket è¿æ¥ç®¡ç†**
```javascript
function initWebSocket() {
  const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
  const wsUrl = `${protocol}//${window.location.host}`;
  ws = new WebSocket(wsUrl);
  // ... äº‹ä»¶å¤„ç†
}
```

2. **MQTT è¿æ¥**
```javascript
function connectMQTT() {
  ws.send(JSON.stringify({
    type: 'connect',
    config: { host, port, username, password }
  }));
}
```

3. **ä¸»é¢˜è®¢é˜…**
```javascript
function subscribe() {
  ws.send(JSON.stringify({
    type: 'subscribe',
    topic: topic
  }));
}
```

4. **æ¶ˆæ¯å‘å¸ƒ**
```javascript
function publish() {
  ws.send(JSON.stringify({
    type: 'publish',
    topic: topic,
    payload: payload,
    qos: qos,        // 0, 1, æˆ– 2
    retain: retain   // true/false
  }));
}
```

5. **å®æ—¶æ¶ˆæ¯æ˜¾ç¤º**
- è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
- é™åˆ¶æ˜¾ç¤º 100 æ¡æ¶ˆæ¯ (é˜²æ­¢å†…å­˜æº¢å‡º)
- æ¶ˆæ¯åŒ…å«æ—¶é—´æˆ³å’Œä¸»é¢˜ä¿¡æ¯

6. **XSS é˜²æŠ¤**
```javascript
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨æŒ‡å—

### æ–¹å¼ä¸€: æœ¬åœ°è¿è¡Œ

```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. å¯åŠ¨æœåŠ¡
npm start
# æˆ–
node server.js

# 3. è®¿é—® Web UI
# æ‰“å¼€æµè§ˆå™¨: http://localhost:3000
```

### æ–¹å¼äºŒ: Docker è¿è¡Œ

```bash
# ä½¿ç”¨ Docker Compose (æ¨è)
docker-compose up -d

# æˆ–æ‰‹åŠ¨æ„å»º
docker build -t mqtt-web-ui .
docker run -d -p 3000:3000 --name mqtt-web-ui mqtt-web-ui
```

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯ 1: åŸºæœ¬æ¶ˆæ¯æ”¶å‘æµ‹è¯•

1. å¯åŠ¨ Web UI: `node server.js`
2. æµè§ˆå™¨è®¿é—®: http://localhost:3000
3. ç‚¹å‡»"è¿æ¥"æŒ‰é’®è¿æ¥åˆ° MQTT
4. è®¢é˜…ä¸»é¢˜: `test`
5. å¦å¼€ç»ˆç«¯è¿è¡Œ: `node publisher.js`
6. Web UI ä¸­å®æ—¶çœ‹åˆ°æ¯ 2 ç§’å‘å¸ƒçš„æ¶ˆæ¯

### åœºæ™¯ 2: æ™ºèƒ½å®¶å±…æ¶ˆæ¯ç›‘æ§

å‡è®¾ä½ æœ‰æ™ºèƒ½å®¶å±…è®¾å¤‡å‘å¸ƒåˆ°ä»¥ä¸‹ä¸»é¢˜:
- `home/kitchen/temperature`
- `home/bedroom/temperature`
- `home/living-room/light`

**è®¢é˜…æ–¹å¼**:
1. è®¢é˜… `home/#` (ç›‘æ§æ‰€æœ‰å®¶å±…è®¾å¤‡)
2. æˆ–è®¢é˜… `home/+/temperature` (åªç›‘æ§æ‰€æœ‰æˆ¿é—´æ¸©åº¦)

### åœºæ™¯ 3: è¿œç¨‹æ§åˆ¶è®¾å¤‡

**å‘å¸ƒæ§åˆ¶æ¶ˆæ¯**:
- ä¸»é¢˜: `home/living-room/light`
- æ¶ˆæ¯: `{"state": "on", "brightness": 80}`
- QoS: 1 (ç¡®ä¿æ¶ˆæ¯é€è¾¾)
- Retain: true (ä¿ç•™æœ€åçŠ¶æ€)

---

## ğŸ” MQTT é€šé…ç¬¦è¯´æ˜

### `#` - å¤šçº§é€šé…ç¬¦
è®¢é˜… `home/#` å¯ä»¥æ¥æ”¶:
- `home/kitchen/temp`
- `home/bedroom/light/state`
- `home/living-room/sensor/motion`

### `+` - å•çº§é€šé…ç¬¦
è®¢é˜… `home/+/temp` å¯ä»¥æ¥æ”¶:
- `home/kitchen/temp` âœ…
- `home/bedroom/temp` âœ…
- `home/living-room/sensor/temp` âŒ (å¤šäº†ä¸€çº§)

---

## ğŸ“Š QoS ç­‰çº§è¯´æ˜

| QoS | åç§° | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|-----|------|------|----------|
| 0 | è‡³å¤šä¸€æ¬¡ | ä¸ä¿è¯é€è¾¾ï¼Œå¯èƒ½ä¸¢å¤± | å®æ—¶æ•°æ®æµã€éå…³é”®ä¿¡æ¯ |
| 1 | è‡³å°‘ä¸€æ¬¡ | ä¿è¯é€è¾¾ï¼Œå¯èƒ½é‡å¤ | ä¸€èˆ¬åº”ç”¨ã€æ—¥å¿—è®°å½• |
| 2 | æ°å¥½ä¸€æ¬¡ | ä¿è¯é€è¾¾ä¸”ä¸é‡å¤ | é‡‘èäº¤æ˜“ã€å…³é”®æ§åˆ¶ |

---

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

### å½“å‰é…ç½® (å¼€å‘ç¯å¢ƒ)
```javascript
const MQTT_CONFIG = {
  host: '27.191.2.71',
  port: 5502,
  username: 'admin',
  password: 'wjm234.CN'  // âš ï¸ ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
};
```

### ç”Ÿäº§ç¯å¢ƒæ”¹è¿›

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
```javascript
const MQTT_CONFIG = {
  host: process.env.MQTT_HOST || '27.191.2.71',
  port: process.env.MQTT_PORT || 5502,
  username: process.env.MQTT_USERNAME,
  password: process.env.MQTT_PASSWORD
};
```

2. **å¯ç”¨ TLS/SSL**
- MQTT over TLS (ç«¯å£ 8883)
- WebSocket over TLS (WSS)

3. **æ·»åŠ è®¤è¯ä¸­é—´ä»¶**
```javascript
// ä¸º Web UI æ·»åŠ ç™»å½•éªŒè¯
app.use('/api', authMiddleware);
```

4. **IP ç™½åå•**
```javascript
const allowedIPs = ['127.0.0.1', '192.168.1.0/24'];
```

---

## ğŸ› å¸¸è§é—®é¢˜ä¸è§£å†³

### é—®é¢˜ 1: WebSocket è¿æ¥å¤±è´¥
**åŸå› **: ç«¯å£è¢«å ç”¨æˆ–é˜²ç«å¢™é˜»æ­¢
**è§£å†³**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3000

# ä¿®æ”¹ç«¯å£
const PORT = 3001;  // åœ¨ server.js ä¸­ä¿®æ”¹
```

### é—®é¢˜ 2: MQTT è¿æ¥è¶…æ—¶
**åŸå› **: MQTT æœåŠ¡å™¨ä¸å¯è¾¾æˆ–è®¤è¯å¤±è´¥
**è§£å†³**:
1. æ£€æŸ¥ MQTT æœåŠ¡å™¨çŠ¶æ€: `docker ps`
2. æµ‹è¯•è¿æ¥: `node subscriber.js`
3. éªŒè¯é˜²ç«å¢™è§„åˆ™

### é—®é¢˜ 3: æ¶ˆæ¯æ”¶ä¸åˆ°
**åŸå› **: ä¸»é¢˜è®¢é˜…ä¸æ­£ç¡®æˆ– QoS ä¸åŒ¹é…
**è§£å†³**:
1. æ£€æŸ¥ä¸»é¢˜æ‹¼å†™
2. ä½¿ç”¨é€šé…ç¬¦æµ‹è¯•: `#`
3. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—é¢æ¿

---

## ğŸ”„ é¡¹ç›®æ‰©å±•å»ºè®®

### åŠŸèƒ½æ‰©å±•

1. **æ¶ˆæ¯æŒä¹…åŒ–**
   - å°†æ¥æ”¶çš„æ¶ˆæ¯ä¿å­˜åˆ°æ•°æ®åº“ (MongoDB/PostgreSQL)
   - æ”¯æŒå†å²æ¶ˆæ¯æŸ¥è¯¢

2. **ä¸»é¢˜ç®¡ç†**
   - ä¸»é¢˜æ”¶è—åŠŸèƒ½
   - å¸¸ç”¨ä¸»é¢˜å¿«æ·è®¢é˜…
   - ä¸»é¢˜åˆ†ç»„ç®¡ç†

3. **æ¶ˆæ¯è¿‡æ»¤**
   - æŒ‰ä¸»é¢˜è¿‡æ»¤
   - æŒ‰æ—¶é—´èŒƒå›´è¿‡æ»¤
   - æŒ‰å†…å®¹æœç´¢

4. **å¯è§†åŒ–å›¾è¡¨**
   - æ¶ˆæ¯é¢‘ç‡å›¾è¡¨
   - ä¸»é¢˜æµé‡ç»Ÿè®¡
   - å®æ—¶æ•°æ®å›¾è¡¨ (Chart.js)

5. **å¤šè¿æ¥æ”¯æŒ**
   - åŒæ—¶ç®¡ç†å¤šä¸ª MQTT æœåŠ¡å™¨
   - è¿æ¥é…ç½®ä¿å­˜

6. **æ¶ˆæ¯æ¨¡æ¿**
   - ä¿å­˜å¸¸ç”¨æ¶ˆæ¯æ¨¡æ¿
   - å¿«é€Ÿå‘å¸ƒé¢„è®¾æ¶ˆæ¯

### æŠ€æœ¯æ”¹è¿›

1. **å‰ç«¯æ¡†æ¶åŒ–**
   - è¿ç§»åˆ° React/Vue.js
   - æ›´å¥½çš„ç»„ä»¶åŒ–ç®¡ç†

2. **çŠ¶æ€ç®¡ç†**
   - Redux/Vuex ç®¡ç†åº”ç”¨çŠ¶æ€
   - æœ¬åœ°å­˜å‚¨é…ç½®ä¿¡æ¯

3. **TypeScript**
   - æ·»åŠ ç±»å‹å®‰å…¨
   - æ›´å¥½çš„ä»£ç æç¤º

4. **å•å…ƒæµ‹è¯•**
   - Jest æµ‹è¯•æ¡†æ¶
   - WebSocket æ¨¡æ‹Ÿæµ‹è¯•

---

## ğŸ“ å¼€å‘æ—¥å¿—

### 2025-11-14 åˆå§‹ç‰ˆæœ¬

**å®Œæˆçš„å·¥ä½œ**:
1. âœ… åˆ›å»º Node.js åç«¯æœåŠ¡ (server.js)
2. âœ… å®ç° WebSocket åŒå‘é€šä¿¡
3. âœ… é›†æˆ MQTT.js å®¢æˆ·ç«¯
4. âœ… åˆ›å»º Web UI ç•Œé¢ (HTML/CSS/JS)
5. âœ… å®ç°æ ¸å¿ƒåŠŸèƒ½:
   - MQTT è¿æ¥ç®¡ç†
   - ä¸»é¢˜è®¢é˜…/å–æ¶ˆè®¢é˜…
   - æ¶ˆæ¯å‘å¸ƒ (æ”¯æŒ QoS å’Œ Retain)
   - å®æ—¶æ¶ˆæ¯ç›‘æ§
   - ç³»ç»Ÿæ—¥å¿—
6. âœ… Docker åŒ–éƒ¨ç½²é…ç½®
7. âœ… å®Œæ•´çš„ README æ–‡æ¡£

**ä¾èµ–ç‰ˆæœ¬**:
- express: ^4.21.2
- mqtt: ^5.14.1
- ws: ^8.18.3

**å·²çŸ¥é™åˆ¶**:
- å•ç”¨æˆ·æ¨¡å¼ (æ— å¤šç”¨æˆ·è®¤è¯)
- æ¶ˆæ¯æœªæŒä¹…åŒ–
- æ— å†å²æ¶ˆæ¯æŸ¥è¯¢

**ä¸‹ä¸€æ­¥è®¡åˆ’**:
- æ·»åŠ ç”¨æˆ·è®¤è¯
- æ¶ˆæ¯æŒä¹…åŒ–åˆ°æ•°æ®åº“
- æ·»åŠ æ•°æ®å¯è§†åŒ–å›¾è¡¨

---

## ğŸ“ å­¦ä¹ è¦ç‚¹

### å¯¹äº AI ä½¿ç”¨è€…

å½“ä½ ä¸‹æ¬¡è®© AI ç»§ç»­å¼€å‘è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œå¯ä»¥è¿™æ ·æé—®:

1. **æ·»åŠ æ–°åŠŸèƒ½**:
   > "åŸºäºè¿™ä¸ª MQTT Web UI é¡¹ç›®ï¼Œå¸®æˆ‘æ·»åŠ æ¶ˆæ¯å†å²è®°å½•åŠŸèƒ½ï¼Œä¿å­˜åˆ° SQLite æ•°æ®åº“"

2. **ä¿®å¤é—®é¢˜**:
   > "Web UI ä¸­çš„æ¶ˆæ¯åˆ—è¡¨æ»šåŠ¨æœ‰é—®é¢˜ï¼Œå¸®æˆ‘çœ‹çœ‹ app.js ä¸­çš„è‡ªåŠ¨æ»šåŠ¨é€»è¾‘"

3. **ä¼˜åŒ–æ”¹è¿›**:
   > "å°†å‰ç«¯ä»£ç æ”¹æˆ Reactï¼Œä¿æŒç°æœ‰åŠŸèƒ½ä¸å˜"

4. **éƒ¨ç½²ç›¸å…³**:
   > "å¸®æˆ‘å†™ä¸€ä¸ª Nginx é…ç½®ï¼Œç”¨äºåå‘ä»£ç†è¿™ä¸ª MQTT Web UI"

### å…³é”®æ¦‚å¿µç†è§£

1. **WebSocket vs HTTP**
   - HTTP: å•å‘è¯·æ±‚-å“åº”
   - WebSocket: åŒå‘å®æ—¶é€šä¿¡
   - æœ¬é¡¹ç›®ä½¿ç”¨ WebSocket å®ç°å‰åç«¯å®æ—¶æ¶ˆæ¯æ¨é€

2. **MQTT æ¶æ„**
   - Publisher (å‘å¸ƒè€…): å‘é€æ¶ˆæ¯
   - Broker (ä»£ç†): Mosquitto æœåŠ¡å™¨
   - Subscriber (è®¢é˜…è€…): æ¥æ”¶æ¶ˆæ¯
   - æœ¬é¡¹ç›®çš„ Web UI æ—¢å¯ä»¥æ˜¯å‘å¸ƒè€…ä¹Ÿå¯ä»¥æ˜¯è®¢é˜…è€…

3. **å®¢æˆ·ç«¯ ID çš„é‡è¦æ€§**
   - æ¯ä¸ª MQTT è¿æ¥éœ€è¦å”¯ä¸€çš„ Client ID
   - æœ¬é¡¹ç›®ä½¿ç”¨æ—¶é—´æˆ³: `web_client_${Date.now()}`
   - å¦‚æœ Client ID é‡å¤ï¼Œä¼šå¯¼è‡´è¿æ¥è¢«è¸¢ä¸‹çº¿

---

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [MQTT.js æ–‡æ¡£](https://github.com/mqttjs/MQTT.js)
- [Eclipse Mosquitto æ–‡æ¡£](https://mosquitto.org/documentation/)
- [WebSocket API](https://developer.mozilla.org/en-US/docs/Web/API/WebSocket)

### MQTT åè®®
- [MQTT 3.1.1 è§„èŒƒ](https://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.html)
- [MQTT 5.0 è§„èŒƒ](https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html)

### ç›¸å…³å·¥å…·
- [MQTT.fx](https://mqttfx.jensd.de/) - MQTT æ¡Œé¢å®¢æˆ·ç«¯
- [MQTT Explorer](https://mqtt-explorer.com/) - å¯è§†åŒ– MQTT å·¥å…·
- [HiveMQ WebSocket Client](http://www.hivemq.com/demos/websocket-client/) - åœ¨çº¿æµ‹è¯•å·¥å…·

---

## ğŸ¤ é¡¹ç›®ç»´æŠ¤

### å¦‚ä½•æ›´æ–°ä¾èµ–

```bash
# æ£€æŸ¥è¿‡æœŸçš„åŒ…
npm outdated

# æ›´æ–°æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°ç‰ˆæœ¬
npm update

# æ›´æ–°åˆ°æœ€æ–°å¤§ç‰ˆæœ¬ (è°¨æ…)
npm install express@latest mqtt@latest ws@latest
```

### å¦‚ä½•å¤‡ä»½é¡¹ç›®

```bash
# åˆ›å»ºå¤‡ä»½ (æ’é™¤ node_modules)
tar -czf mqtt-web-ui-backup-$(date +%Y%m%d).tar.gz \
  --exclude='node_modules' \
  --exclude='.git' \
  .
```

### å¦‚ä½•è¿ç§»åˆ°æ–°æœåŠ¡å™¨

1. å¤åˆ¶æ•´ä¸ªé¡¹ç›®ç›®å½•
2. ä¿®æ”¹ `server.js` ä¸­çš„ MQTT_CONFIG
3. è¿è¡Œ `npm install`
4. å¯åŠ¨æœåŠ¡: `node server.js`

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜:

1. **æŸ¥çœ‹æ—¥å¿—**: Web UI ä¸­çš„ç³»ç»Ÿæ—¥å¿—é¢æ¿
2. **æŸ¥çœ‹æ§åˆ¶å°**: æµè§ˆå™¨å¼€å‘è€…å·¥å…· Console
3. **æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—**: è¿è¡Œ `node server.js` çš„ç»ˆç«¯è¾“å‡º
4. **æŸ¥çœ‹ Docker æ—¥å¿—**: `docker logs mqtt-web-ui`

---

**æœ¬æ–‡æ¡£ç”± AI (Claude Sonnet 4.5) ç”Ÿæˆ**
**æœ€åæ›´æ–°**: 2025-11-14
**é¡¹ç›®ç‰ˆæœ¬**: v1.0.0